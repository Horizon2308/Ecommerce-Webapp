<app-header></app-header>
<div class="container">
  <div class="intro-section">
    <h1>Chi tiết sản phẩm</h1>
  </div>
  <div class="row">
    <div class="col-md-6">
      <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          <div
            *ngFor="let image of product?.product_images; let i = index"
            class="carousel-item"
            [ngClass]="{ active: i === currentIndexImage }"
          >
            <div class="square-image">
              <img
                [src]="image.url"
                class="product-image"
                alt="Product Image"
              />
            </div>
          </div>
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#carouselExample"
          data-bs-slide="prev"
          (click)="previousImage()"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#carouselExample"
          data-bs-slide="next"
          (click)="nextImage()"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
      <div class="row">
        <div class="thumbnail-container">
          <div
            *ngFor="let image of product?.product_images; let i = index"
            class="thumbnail-item"
            [ngClass]="{ active: i === currentIndexImage }"
            (click)="thumbnailClick(i)"
          >
            <img
              [src]="image.url"
              class="thumbnail-image"
              alt="Thumbnail Image"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="product-details">
        <h2>{{ product?.name }}</h2>
        <!-- <p>{{ product?.description }}</p> -->
        <p>Giá: {{ product?.price | number : "1.2" }} vnđ</p>
        <p>Số lượng tồn ở kho: {{ product?.quantity }} sản phẩm</p>
        <!-- <p>Tổng tiền: ${{ getTotalPrice() | number:'1.2-2' }}</p> -->
        <div class="product-actions">
          <button class="btn btn-primary" (click)="addProductToCart()">
            Thêm vào giỏ hàng
          </button>
          <button class="btn btn-success" (click)="buyNow()">Mua ngay</button>
        </div>
        <div class="product-quantity">
          <div class="border-wrapper">
            <button (click)="decreaseQuantity()">-</button>
            <input type="text" [value]="quantity" />
            <button (click)="increaseQuantity()">+</button>
          </div>
        </div>
      </div>
      <div class="description-container">
        <div class="description-title">Mô tả Sản Phẩm</div>
        <p class="description-text">
          {{ product?.description }}
        </p>
      </div>
    </div>
  </div>
</div>
<div class="comment-section">
  <h2>Bình luận</h2>
  <div class="comment-form">
    <textarea
      [(ngModel)]="commentDTO.content"
      placeholder="Viết bình luận..."
    ></textarea>
    <button type="button" (click)="addComment()">Gửi bình luận</button>
  </div>
  <div class="comments-list">
    <div class="comment" *ngFor="let comment of comments">
      <div style="display: flex">
        <div class="comment-header">{{ comment.username }}</div>
        <span style="margin-left: 20px">{{
          comment.created_at | ddMmYYYYDate
        }}</span>
      </div>
      <div class="comment-body">{{ comment.content }}</div>
      <div class="comment-actions">
        <button (click)="likeButton(comment.id)">
          {{ comment.isLikedByThisUser ? "❤️" : "♡" }} {{ comment.likes }}
        </button>
        <button style="font-size: 15px;">Reply</button>
      </div>
      <!-- <div class="replies">
              <div class="reply-form" *ngIf="comment.showReply">
                  <textarea #replyBody placeholder="Viết phản hồi..."></textarea>
                  <button type="button" >Gửi phản hồi</button>
              </div>
              <div class="comment" *ngFor="let reply of comment.replies">
                  <div class="comment-header">{{reply.name}}</div>
                  <div class="comment-body">{{reply.body}}</div>
                  <div class="comment-actions">
                      <button >
                        {{ reply.likedByUser ? '❤️' : '♡' }} {{ reply.likes }}
                      </button>
                      <button (click)="reply.showReply = !reply.showReply">Reply</button>
                  </div>
                  <div class="replies">
                      <div class="reply-form" *ngIf="reply.showReply">
                          <input type="text" #nestedReplyName placeholder="Tên của bạn">
                          <textarea #nestedReplyBody placeholder="Viết phản hồi..."></textarea>
                          <button type="button" (click)="addReply(reply, nestedReplyName.value, nestedReplyBody.value)">Gửi phản hồi</button>
                      </div>
                  </div>
              </div>
          </div> -->
    </div>
  </div>
  <div class="d-flex justify-content-center">
    <nav aria-label="Page navigation">
      <ul class="pagination">
        <li class="page-item" *ngIf="currentPage > 0">
          <a class="page-link" (click)="onPageChange(0)">First</a>
        </li>
        <li class="page-item" *ngIf="currentPage > 0">
          <a class="page-link" (click)="onPageChange(currentPage - 1)">
            <i class="fa fa-chevron-left"></i>
          </a>
        </li>
        <ng-container *ngFor="let page of visiblePages">
          <li
            class="page-item"
            [ngClass]="{ active: page === currentPage + 1 }"
          >
            <a class="page-link" (click)="onPageChange(page - 1)">{{ page }}</a>
          </li>
        </ng-container>
        <li class="page-item" *ngIf="currentPage < totalPages - 1">
          <a class="page-link" (click)="onPageChange(currentPage + 1)">
            <i class="fa fa-chevron-right"></i>
          </a>
        </li>
        <li class="page-item" *ngIf="currentPage < totalPages - 1">
          <a class="page-link" (click)="onPageChange(totalPages - 1)">Last</a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<app-footer>
  <footer></footer>
</app-footer>
